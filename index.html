<script>
  async function submitForm(e) {
    e.preventDefault();
    const email = document.getElementById('email').value.trim();
    const confirmation = document.getElementById('confirmation');

    if (!email) {
      alert("Please enter a valid email.");
      return;
    }

    try {
      const res = await fetch("https://zasmhtqyfkxgeudktfys.supabase.co/functions/v1/send-welcome-email", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ email, name: "Beta Waitlist Signup" }) // name is required by your function
      });

      if (res.ok) {
        confirmation.innerText = "ðŸŽ‰ You're on the list!";
        confirmation.style.display = 'block';
      } else {
        const err = await res.json();
        alert("Error: " + (err.error || "Something went wrong"));
      }
    } catch (err) {
      console.error("Fetch error:", err);
      alert("Could not connect to server.");
    }
  }
</script>

    async function handleSubmit(event) {
      event.preventDefault();

      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;
      const bio = document.getElementById('bio').value.trim();
      const category = document.getElementById('category').value;

      if (!name || !email || !password || !bio || !category) {
        alert("Please complete all required fields.");
        return;
      }

      const data = {
        name,
        email,
        password,
        bio,
        category,
        instagram: document.getElementById('instagram').value.trim(),
        tiktok: document.getElementById('tiktok').value.trim(),
        pro: document.getElementById('proOptIn').checked
      };

      await fetch('https://zasmhtqyfkxgeudktfys.supabase.co/functions/v1/signup-creator', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      fetch("https://api.emailjs.com/api/v1.0/email/send", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          service_id: "your_service_id",
          template_id: "your_template_id",
          user_id: "your_user_id",
          template_params: {
            user_email: email,
            user_name: name
          }
        })
      });

      document.getElementById('creatorForm').reset();
      document.getElementById('successMsg').style.display = 'block';
    }
  </script>
</body>
</html>
